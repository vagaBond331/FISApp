@model FISApp.Models.UpdateEmpImageModel
@{
    ViewBag.Title = "UpdateEmpImage";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@*<div class="panel panel-widget forms-panel" style="width: 26.9%; display: inline-block">
    <div class="forms">
        <div class="form-grids widget-shadow" data-example-id="basic-forms">
            <div class="form-title">
                <h3>Avatar</h3>
            </div>
            <div>
                @Html.TextBoxFor(model => model._avatar, new { type = "file", id = "_avatar", @class = "upload" })
            </div>
            <div class="form-body" style="padding:0px;">
                <div class="form-group">
                    <div class="col-md-5 header-left" style="padding:0px">
                        <img height="300" width="300" src="@Model.avatar" id="imgavatar" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="panel panel-widget forms-panel" style="width: 26.9%; display: inline-block;">
    <div class="forms">
        <div class="form-grids widget-shadow" data-example-id="basic-forms">
            <div class="form-title">
                <h3>Fingerprint Image</h3>
            </div>
            <div class="form-body" style="padding:0px;">
                <div class="form-group">
                    <div class="col-md-5 header-left" style="padding:0px">
                        <img height="300" width="300" src="@Model.finger_image_src" id="finger" />
                    </div>
                    <input type="submit" value="Refresh" onclick="return Validate();" class="btn btn-default" />
                </div>
            </div>
        </div>
    </div>
</div>*@



<div class="panel panel-widget forms-panel">
    <div class="forms" style="background-color: #00acc1;">
        <div class="form-grids widget-shadow" data-example-id="basic-forms">
            <div class="col-md-7 header-right">
                <h1>Hi !</h1>
                <h6>@Model.profile.position</h6>
                <ul class="address">
                    <li>
                        <ul class="address-text">
                            <li><b>NAME</b></li>
                            <li>@Model.profile.name</li>
                        </ul>
                    </li>
                    <li>
                        <ul class="address-text">
                            <li><b>D.O.B</b></li>
                            <li>@Model.profile.DOB</li>
                        </ul>
                    </li>
                    <li>
                        <ul class="address-text">
                            <li><b>PHONE </b></li>
                            <li>@Model.profile.phone</li>
                        </ul>
                    </li>
                    <li>
                        <ul class="address-text">
                            <li><b>DEPARTMENT </b></li>
                            <li>@Model.profile.department</li>
                        </ul>
                    </li>
                    <li>
                        <ul class="address-text">
                            <li><b>ADDRESS </b></li>
                            <li>@Model.profile.address</li>
                        </ul>
                    </li>
                    <li>
                        <ul class="address-text">
                            <li><b>E-MAIL </b></li>
                            <li><a href="mailto:example@mail.com">@Model.profile.email</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="col-md-5 header-left">
                @Html.TextBoxFor(model => model._avatar, new { type = "file", id = "_avatar", @class = "upload" })
                <img src="@Model.avatar" id="imgavatar" />
            </div>
            <div class="clearfix"> </div>
        </div>
    </div>
</div>





<script type="text/javascript">

    function Validate() {
        var s = $("#finger_image_src").val();
        if (s == "" || s == "/Images/User/default.jpg") {
            console.log("false");
        } else if (s.includes("@Model.user_id" + ".bmp")) {
            console.log("True");
            return true;
        }
        swal("Waiting for scanning fingerprint");
        return false;
    }

    $(document).ready(function () {
        var scanfingerimage = function () {
            $.ajax({
                url: 'RequestFingerImage',
                type: 'POST',
                error: function (request) { },
                success: function (data) {
                    if (data.Success == true) {
                        $("#finger_image_src").val(data.Path);
                        $('#finger').attr('src', data.Path);
                    } else {
                        setTimeout(scanfingerimage, 5000);
                    }

                }
            });
        };
        scanfingerimage();
        swal("@Model.user_id was registered", "Now you can update avatar and fingerprint.")
    });

    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#imgavatar').attr('src', e.target.result);
            }

            reader.readAsDataURL(input.files[0]);
        }
    }

    $("#_avatar").change(function () {
        readURL(this);
    });
</script>